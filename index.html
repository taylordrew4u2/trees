<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>The Bit Binder</title>
    <link rel="stylesheet" href="style.css">
    <!-- ElevenLabs Conversational AI Widget -->
    <elevenlabs-convai agent-id="agent_7401ka31ry6qftr9ab89em3339w9"></elevenlabs-convai>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>
</head>
<body>
    <!-- Launch Screen -->
    <div id="launch-screen">
        <div class="launch-content">
            <div class="launch-icon">üé§</div>
            <h1 class="launch-title">The Bit Binder</h1>
            <p class="launch-subtitle">Your comedy companion</p>
        </div>
    </div>

    <!-- Password Gate -->
    <div id="password-gate" style="display:none;">
        <div class="password-card">
            <div class="password-icon">üé§</div>
            <h1>The Bit Binder</h1>
            <p>Enter password to continue</p>
            <form id="password-form">
                <input type="password" id="password-input" placeholder="Password" autocomplete="current-password">
                <button type="submit" class="btn-primary">Enter</button>
            </form>
            <p id="password-error" class="password-error" style="display:none;">Incorrect password. Try again.</p>
        </div>
    </div>

    <!-- Side Menu Overlay -->
    <div id="side-menu-overlay" class="side-menu-overlay"></div>

    <!-- Glassmorphic Side Menu -->
    <div id="side-menu" class="side-menu">
        <div class="side-menu-header">
            <h2 class="side-menu-brand">BitBinder</h2>
            <span class="side-menu-version">v8.0</span>
            <button id="close-menu-btn" class="close-menu-btn" aria-label="Close menu">&times;</button>
        </div>
        <div class="side-menu-items">
            <button class="side-menu-item" data-view="notepad" data-color="blue">
                <span class="smi-icon">‚úèÔ∏è</span>
                <span class="smi-label">Notepad</span>
                <span class="smi-desc">Quick joke writing</span>
            </button>
            <button class="side-menu-item" data-view="jokes" data-color="orange">
                <span class="smi-icon">üòÑ</span>
                <span class="smi-label">Jokes</span>
                <span class="smi-desc">Joke library &amp; folders</span>
            </button>
            <button class="side-menu-item" data-view="setlists" data-color="purple">
                <span class="smi-icon">üìã</span>
                <span class="smi-label">Set Lists</span>
                <span class="smi-desc">Curate comedy sets</span>
            </button>
            <button class="side-menu-item" data-view="recordings" data-color="red">
                <span class="smi-icon">üéôÔ∏è</span>
                <span class="smi-label">Recordings</span>
                <span class="smi-desc">Audio recordings</span>
            </button>
            <button class="side-menu-item" data-view="notebook" data-color="brown">
                <span class="smi-icon">üìì</span>
                <span class="smi-label">Notebook</span>
                <span class="smi-desc">Photo-based notebook</span>
            </button>
        </div>
    </div>

    <div id="app" style="display:none;">
        <header>
            <h1>The Bit Binder</h1>
            <nav>
                <button data-view="notepad">Notepad</button>
                <button data-view="jokes">Jokes</button>
                <button data-view="setlists">Set Lists</button>
                <button data-view="recordings">Recordings</button>
                <button data-view="notebook">Notebook</button>
            </nav>
        </header>

        <main id="main-content">
            <!-- Views are dynamically loaded here -->
        </main>

        <!-- Floating Menu Button -->
        <button id="floating-menu-btn" class="floating-menu-btn" aria-label="Open menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
            </svg>
        </button>
    </div>

    <!-- Templates for views (hidden) -->
    <div id="templates" style="display:none;">
        <!-- Home view -->
        <div id="home-view" class="view">
            <div class="home-buttons">
                <button class="home-button home-button--blue" data-view="notepad">
                    <span class="icon">‚úèÔ∏è</span>
                    <div>
                        <span class="title">Notepad</span>
                        <span class="subtitle">Quick joke writing</span>
                    </div>
                </button>
                <button class="home-button home-button--orange" data-view="jokes">
                    <span class="icon">üòÑ</span>
                    <div>
                        <span class="title">Jokes</span>
                        <span class="subtitle">Manage your joke library</span>
                    </div>
                </button>
                <button class="home-button home-button--purple" data-view="setlists">
                    <span class="icon">üìã</span>
                    <div>
                        <span class="title">Set Lists</span>
                        <span class="subtitle">Curate comedy sets</span>
                    </div>
                </button>
                <button class="home-button home-button--red" data-view="recordings">
                    <span class="icon">üéôÔ∏è</span>
                    <div>
                        <span class="title">Recordings</span>
                        <span class="subtitle">Record performances</span>
                    </div>
                </button>
                <button class="home-button home-button--brown" data-view="notebook">
                    <span class="icon">üìì</span>
                    <div>
                        <span class="title">Notebook</span>
                        <span class="subtitle">Photo-based notebook</span>
                    </div>
                </button>
            </div>
        </div>

        <!-- Jokes list view -->
        <div id="jokes-view" class="view">
            <div class="view-header">
                <h2>Jokes</h2>
                <div class="view-header-actions">
                    <button id="manage-folders-btn" class="btn-secondary">üìÅ Folders</button>
                    <button id="add-joke-btn" class="btn-primary">+ Add Joke</button>
                </div>
            </div>
            <!-- Folder bar -->
            <div class="folder-bar" id="folder-bar">
                <button class="folder-chip active" data-folder="">All Jokes</button>
            </div>
            <div class="search-bar">
                <input type="text" id="joke-search" placeholder="Search jokes..." aria-label="Search jokes">
            </div>
            <div class="filter-bar">
                <select id="joke-sort" aria-label="Sort jokes">
                    <option value="newest">Newest first</option>
                    <option value="oldest">Oldest first</option>
                    <option value="title">Title A‚ÄìZ</option>
                    <option value="rating">Highest rated</option>
                </select>
                <select id="joke-filter-status" aria-label="Filter by status">
                    <option value="">All Statuses</option>
                    <option value="idea">üí° Idea</option>
                    <option value="draft">‚úèÔ∏è Draft</option>
                    <option value="stage-ready">üé§ Stage Ready</option>
                    <option value="retired">üì¶ Retired</option>
                </select>
                <input type="text" id="joke-filter-category" placeholder="Category filter..." aria-label="Filter by category">
            </div>
            <div id="jokes-list" class="list"></div>
        </div>

        <!-- Add/Edit Joke view -->
        <div id="joke-form-view" class="view">
            <div class="view-header">
                <h2 id="joke-form-title">Add Joke</h2>
                <button id="cancel-joke-btn" class="btn-secondary">Cancel</button>
            </div>
            <form id="joke-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="joke-title">Title (1-20 chars)</label>
                        <input type="text" id="joke-title" maxlength="20" required>
                    </div>
                    <div class="form-group">
                        <label for="joke-status">Status</label>
                        <select id="joke-status">
                            <option value="idea">üí° Idea</option>
                            <option value="draft">‚úèÔ∏è Draft</option>
                            <option value="stage-ready">üé§ Stage Ready</option>
                            <option value="retired">üì¶ Retired</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="joke-folder">Folder</label>
                    <select id="joke-folder">
                        <option value="">No folder</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Rating</label>
                    <div class="star-rating" id="joke-rating" role="group" aria-label="Joke rating">
                        <button type="button" class="star" data-value="1">‚òÖ</button>
                        <button type="button" class="star" data-value="2">‚òÖ</button>
                        <button type="button" class="star" data-value="3">‚òÖ</button>
                        <button type="button" class="star" data-value="4">‚òÖ</button>
                        <button type="button" class="star" data-value="5">‚òÖ</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="joke-setup">Setup</label>
                    <textarea id="joke-setup" rows="3" placeholder="The setup of the joke..."></textarea>
                </div>
                <div class="form-group">
                    <label for="joke-punchline">Punchline</label>
                    <textarea id="joke-punchline" rows="2" placeholder="The punchline..."></textarea>
                </div>
                <div class="form-group">
                    <label for="joke-body">Notes</label>
                    <textarea id="joke-body" rows="4" placeholder="Additional notes, variations, context..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="joke-category">Category</label>
                        <input type="text" id="joke-category" maxlength="30" placeholder="e.g. Observational">
                    </div>
                    <div class="form-group">
                        <label for="joke-tags">Tags (comma-separated)</label>
                        <input type="text" id="joke-tags" placeholder="e.g. dark, callback">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save</button>
                    <button type="button" id="delete-joke-btn" class="btn-danger" style="display:none;">Delete</button>
                </div>
            </form>
        </div>

        <!-- Joke Folders Manager view -->
        <div id="joke-folders-view" class="view">
            <div class="view-header">
                <h2>Joke Folders</h2>
                <button id="back-from-folders" class="btn-secondary">Back</button>
            </div>
            <div class="form-group" style="margin-top:16px;">
                <label for="new-folder-name">Create Folder</label>
                <div class="inline-form">
                    <input type="text" id="new-folder-name" maxlength="40" placeholder="Folder name...">
                    <button id="create-folder-btn" class="btn-primary">Create</button>
                </div>
            </div>
            <div id="folders-list" class="list" style="margin-top:16px;"></div>
        </div>

        <!-- Set Lists view -->
        <div id="setlists-view" class="view">
            <div class="view-header">
                <h2>Set Lists</h2>
                <button data-view="create-setlist" class="btn-primary">+ New Set List</button>
            </div>
            <div id="setlists-list" class="list"></div>
        </div>

        <!-- Set List Detail view -->
        <div id="setlist-detail-view" class="view">
            <div class="view-header">
                <h2 id="setlist-name"></h2>
                <button id="back-from-setlist" class="btn-secondary">Back</button>
            </div>
            <div class="setlist-actions">
                <button id="record-set-btn" class="btn-primary">Record Set</button>
                <button id="edit-order-btn" class="btn-secondary">Edit Order</button>
                <button id="rename-setlist-btn" class="btn-secondary">Rename</button>
                <button id="delete-setlist-btn" class="btn-danger">Delete Set List</button>
            </div>
            <div class="setlist-notes">
                <label for="setlist-notes">Post-Set Notes</label>
                <textarea id="setlist-notes" rows="4" placeholder="Add notes about this set..."></textarea>
            </div>
            <div class="setlist-jokes">
                <h3>Jokes in this set</h3>
                <ul id="setlist-jokes-list"></ul>
            </div>
        </div>

        <!-- Create/Edit Set List view -->
        <div id="create-setlist-view" class="view">
            <div class="view-header">
                <h2 id="create-setlist-title">Create Set List</h2>
                <button id="cancel-create-setlist" class="btn-secondary">Cancel</button>
            </div>
            <form id="create-setlist-form">
                <div class="form-group">
                    <label for="setlist-name-input">Set List Name (1-50 chars)</label>
                    <input type="text" id="setlist-name-input" maxlength="50" required>
                </div>
                <div class="joke-picker">
                    <h3>Available Jokes</h3>
                    <div id="available-jokes-list" class="joke-grid"></div>
                    <h3>Selected Jokes (drag to reorder)</h3>
                    <ul id="selected-jokes-list" class="sortable-list"></ul>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save Set List</button>
                </div>
            </form>
        </div>

        <!-- Recordings view -->
        <div id="recordings-view" class="view">
            <div class="view-header">
                <h2>Recordings</h2>
            </div>
            <div id="recordings-list" class="list"></div>
        </div>

        <!-- Recording Detail view -->
        <div id="recording-detail-view" class="view">
            <div class="view-header">
                <h2 id="recording-name"></h2>
                <button id="back-from-recording" class="btn-secondary">Back</button>
            </div>
            <div class="recording-player">
                <audio id="recording-audio" controls></audio>
                <div class="recording-info">
                    <p>Duration: <span id="recording-duration"></span></p>
                </div>
            </div>
            <div class="recording-notes">
                <label for="recording-notes">Notes</label>
                <textarea id="recording-notes" rows="4" placeholder="Add notes about this recording..."></textarea>
            </div>
            <div class="recording-actions">
                <button id="export-recording-btn" class="btn-secondary">Export Audio</button>
                <button id="delete-recording-btn" class="btn-danger">Delete Recording</button>
            </div>
        </div>

        <!-- Recording interface view -->
        <div id="record-set-view" class="view">
            <div class="view-header">
                <h2>Recording: <span id="record-setlist-name"></span></h2>
                <button id="cancel-recording-btn" class="btn-secondary">Cancel</button>
            </div>
            <div id="mic-status" class="mic-status" aria-live="polite"></div>
            <div class="recording-timer" id="recording-timer">00:00</div>
            <div class="recording-controls">
                <button id="start-record-btn" class="record-btn">Start</button>
                <button id="pause-record-btn" class="record-btn" style="display:none;">Pause</button>
                <button id="resume-record-btn" class="record-btn" style="display:none;">Resume</button>
                <button id="stop-record-btn" class="record-btn stop" style="display:none;">Stop</button>
            </div>
            <div class="setlist-preview">
                <h3>Set List Order</h3>
                <ul id="recording-setlist-jokes"></ul>
            </div>
        </div>

        <!-- Notepad view -->
        <div id="notepad-view" class="view">
            <div class="view-header">
                <h2>Notepad</h2>
                <button id="export-to-joke-btn" class="btn-secondary">‚ûï Export to Joke</button>
            </div>
            <p class="notepad-hint">Brain-dump your ideas here. Auto-saves as you type.</p>
            <textarea id="notepad-text" class="notepad-textarea" rows="16" placeholder="Write anything here ‚Äî premises, observations, one-liners..."></textarea>
            <div class="notepad-actions">
                <button id="clear-notepad-btn" class="btn-danger">Clear</button>
            </div>
        </div>

        <!-- Notebook view (photo-based) -->
        <div id="notebook-view" class="view">
            <div class="view-header">
                <h2>Notebook</h2>
                <button id="add-notebook-entry-btn" class="btn-primary">+ New Entry</button>
            </div>
            <div class="search-bar">
                <input type="text" id="notebook-search" placeholder="Search entries..." aria-label="Search notebook">
            </div>
            <div id="notebook-list" class="list"></div>
        </div>

        <!-- Notebook Entry view (photo-based) -->
        <div id="notebook-entry-view" class="view">
            <div class="view-header">
                <h2 id="notebook-entry-form-title">New Entry</h2>
                <button id="cancel-notebook-entry-btn" class="btn-secondary">Back</button>
            </div>
            <form id="notebook-entry-form">
                <div class="form-group">
                    <label for="entry-title">Title</label>
                    <input type="text" id="entry-title" maxlength="60" placeholder="Entry title..." required>
                </div>
                <div class="form-group">
                    <label>Photos</label>
                    <div class="photo-upload-area" id="photo-upload-area">
                        <input type="file" id="photo-input" accept="image/*" capture="environment" multiple style="display:none;">
                        <button type="button" id="take-photo-btn" class="btn-secondary">üì∑ Take Photo</button>
                        <button type="button" id="import-photo-btn" class="btn-secondary">üñºÔ∏è Import Photo</button>
                    </div>
                    <div id="photo-previews" class="photo-previews"></div>
                </div>
                <div class="form-group">
                    <label for="entry-content">Notes</label>
                    <textarea id="entry-content" rows="8" placeholder="Write your observation, bit, or note..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Save</button>
                    <button type="button" id="delete-notebook-entry-btn" class="btn-danger" style="display:none;">Delete</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
